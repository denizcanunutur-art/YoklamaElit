<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Elit Eğitim Kurumu - Yoklama Sistemi</title>
<style>
:root{--red:#e74c3c;--green:#25d366;--blue:#2d6cdf;--muted:#f7f7f7;}
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:"Montserrat",Arial,sans-serif;min-height:100vh;background:linear-gradient(135deg,#1c2b5b,#3a5ea0);color:#222;}

/* --- Giriş Paneli --- */
#loginPanel{position:fixed;inset:0;display:flex;justify-content:center;align-items:center;background:linear-gradient(135deg,#1c2b5b,#3a5ea0);z-index:100;}
#loginBox{display:flex;max-width:900px;width:90%;background:rgba(255,255,255,0.95);border-radius:12px;overflow:hidden;box-shadow:0 12px 30px rgba(0,0,0,0.3);flex-direction:row;min-height:400px;}
#loginLogo{flex:1;display:flex;justify-content:center;align-items:center;background:#fff;}
#loginLogo img{max-width:80%;max-height:80%;}
#loginButtons{flex:1;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:30px;}
#loginButtons h2{margin-bottom:30px;font-size:24px;font-weight:700;color:#333;}
.loginBtn{width:80%;padding:14px 20px;margin:10px 0;font-size:18px;font-weight:700;border:none;border-radius:10px;cursor:pointer;transition:0.3s;}
#teacherBtn{background:var(--blue);color:#fff;}
#teacherBtn:hover{background:#1b4bb8;}
#parentBtn{background:var(--green);color:#fff;}
#parentBtn:hover{background:#1aa858;}
#passwordPanel{display:none;flex-direction:column;align-items:center;}
#passwordPanel input{width:80%;padding:10px;margin:10px 0;border-radius:8px;border:1px solid #dcdcdc;font-size:16px;}
#passwordPanel button{margin-top:10px;padding:10px 18px;font-weight:700;border:none;border-radius:8px;background:var(--blue);color:#fff;cursor:pointer;transition:0.3s;}
#passwordPanel button:hover{background:#1b4bb8;}

/* --- Ana Panel --- */
header{background:rgba(255,255,255,0.92);padding:20px 12px;text-align:center;box-shadow:0 2px 8px rgba(0,0,0,0.06);display:none;}
header h1{margin:0;font-size:28px;font-weight:800}
header h1 span{color:var(--red)}
header h2{margin:6px 0 0 0;font-size:15px;color:#555;font-weight:600}
main{display:none;padding:18px;justify-content:center;flex-wrap:wrap;gap:18px;}

/* --- Veli modu tabloları --- */
#parentTableWrap{display:none;max-width:1000px;margin:20px auto;background:rgba(255,255,255,0.95);border-radius:10px;overflow:auto;padding:12px;}
#parentTableWrap h3{font-size:22px;text-align:center;margin-bottom:12px;}
#parentTableWrap p{font-size:14px;color:#555;text-align:center;margin-bottom:10px;}
#parentTable{width:100%;border-collapse:collapse;}
#parentTable th, #parentTable td{text-align:left;padding:12px;border-bottom:1px solid #ddd;font-size:16px;}
.status-dot{display:inline-block;width:14px;height:14px;border-radius:50%;margin-right:8px;}
.status-present{background:var(--green);}
.status-absent{background:var(--red);}
#parentTable tbody tr:hover{background:none;}

/* --- Öğretmen modu stilleri (mevcut kod) */
.panel{background:rgba(255,255,255,0.96);border-radius:10px;padding:14px;box-shadow:0 6px 20px rgba(0,0,0,0.05);flex:1 1 420px;min-width:300px;position:relative;}
h3{margin:0 0 10px 0;font-size:18px;}
.table-wrap{max-height:440px;overflow-y:auto;overflow-x:hidden;border-radius:6px;border:1px solid #e6e6e6;background:#fff;}
table{width:100%;border-collapse:collapse;}
thead th{position:sticky;top:0;background:var(--muted);border-bottom:1px solid #e6e6e6;padding:10px;font-weight:700;text-align:left;}
tbody td{padding:10px;border-bottom:1px solid #f0f0f0;text-align:left;}
tbody tr:hover{background:rgba(0,0,0,0.03);}
td.name{font-weight:700;}
.status-cell{width:110px;text-align:center;cursor:pointer;border-radius:6px;padding:6px;font-weight:700;}
.status-empty{background:transparent;color:#333;}
.status-absent{background:#ffd8d8;color:#800;}
.status-present{background:#d6ffd9;color:#064;}
.btn{display:inline-block;padding:8px 12px;border-radius:8px;border:0;cursor:pointer;font-weight:700;}
.btn-primary{background:var(--blue);color:#fff;}
.btn-danger{background:#ff6b6b;color:#fff;}
.btn-wa{background:var(--green);color:#fff;}
.btn-notify{background:#4a69bd;color:#fff;margin-left:10px;}
.btn-panel{position:absolute;right:14px;top:14px;background:#bdbdbd;color:#fff;}
.btn-class{background:#eee;color:var(--blue);margin:2px;padding:6px 10px;border-radius:6px;cursor:pointer;font-weight:700;}
#overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.45);z-index:40;}
#panel{display:none;position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);z-index:50;width:92%;max-width:520px;}
#panel .panel-inner{background:#fff;padding:18px;border-radius:10px;box-shadow:0 12px 30px rgba(0,0,0,0.2);}
.panel-inner input{width:100%;padding:10px;margin:6px 0;border-radius:8px;border:1px solid #dcdcdc;}
#classButtons{display:flex;flex-wrap:wrap;justify-content:center;margin-bottom:12px;}

@media(max-width:900px){main{flex-direction:column;padding:12px}#loginBox{flex-direction:column;min-height:500px;}}

</style>
</head>
<body>

<!-- Giriş Paneli -->
<div id="loginPanel">
  <div id="loginBox">
    <div id="loginLogo">
      <img src="elit_logo.png" alt="Elit Logo">
    </div>
    <div id="loginButtons">
      <h2>Giriş Seçeneğini Seçiniz</h2>
      <button id="teacherBtn" class="loginBtn">Öğretmen Girişi</button>
      <button id="parentBtn" class="loginBtn">Veli Girişi</button>
      <div id="passwordPanel">
        <input type="password" id="teacherPassword" placeholder="Şifreyi Girin">
        <button id="teacherLoginBtn">Giriş Yap</button>
      </div>
    </div>
  </div>
</div>

<!-- Veli Modu Tablosu -->
<div id="parentTableWrap">
  <h3>Öğrenci Yoklama Listesi (Veli Görünümü)</h3>
  <p>Bu liste yalnızca bilgilendirme amaçlıdır.</p>
  <table id="parentTable">
    <thead><tr><th>İsim</th><th>Sınıf</th><th>Durum</th></tr></thead>
    <tbody></tbody>
  </table>
</div>

<!-- Öğretmen Modu -->
<header>
  <h1><span>Elit</span> Eğitim Kurumu</h1>
  <h2>Yoklama Alma Sistemi</h2>
</header>

<main>
  <!-- Mevcut öğretmen panelleri buraya gelecek (senin eski kodun) -->
</main>

<!-- Öğrenci ekle/sil paneli -->
<div id="overlay"></div>
<div id="panel" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="panel-inner">
    <h3>Öğrenci Yönetimi</h3>
    <input id="newName" type="text" placeholder="Ad Soyad" />
    <input id="newClass" type="text" placeholder="Sınıf (örn: 11Say)" />
    <input id="newPhone" type="text" placeholder="Telefon (örn +90...)" />
    <div style="display:flex;gap:8px;margin-top:8px">
      <button class="btn btn-primary" id="btnAdd">Ekle</button>
      <button class="btn" id="btnClear">Temizle</button>
    </div>
    <hr style="margin:12px 0">
    <div style="font-weight:700;margin-bottom:6px">Öğrenci Sil</div>
    <input id="removeName" type="text" placeholder="Silinecek öğrenci adı" />
    <div style="display:flex;gap:8px;margin-top:8px">
      <button class="btn btn-danger" id="btnRemove">Sil</button>
      <button class="btn" id="btnClose">Kapat</button>
    </div>
  </div>
</div>

<script type="module">
// Firebase import
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
import { getFirestore, collection, getDocs, setDoc, doc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBka7ReTV8sGjR9GAsJUDkksLSCTHCV9Mk",
  authDomain: "elit-yoklama.firebaseapp.com",
  projectId: "elit-yoklama",
  storageBucket: "elit-yoklama.firebasestorage.app",
  messagingSenderId: "30260081027",
  appId: "1:30260081027:web:9332093cbc19d605d506b6"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const INSTITUTION_PHONE = "+905527112922";

let isParentMode=false;
let students=[];
let statuses={};

// --- Firebase yükleme ---
async function loadStudents(){
  students=[];
  const querySnapshot = await getDocs(collection(db,"students"));
  querySnapshot.forEach(docSnap=>{students.push({...docSnap.data()});});
  if(isParentMode){ renderParentTable(); }else{ renderClassButtons(); renderStudentsTable(); }
}

// --- Veli tablosu ---
function renderParentTable(){
  document.getElementById("parentTableWrap").style.display="block";
  const tbody=document.querySelector("#parentTable tbody");
  tbody.innerHTML="";
  students.forEach(s=>{
    const tr=document.createElement("tr");
    const tdName=document.createElement("td"); tdName.textContent=s.name;
    const tdClass=document.createElement("td"); tdClass.textContent=s.class;
    const tdStatus=document.createElement("td");
    const dot=document.createElement("span"); dot.className="status-dot "+(statuses[s.name]==="absent"?"status-absent":"status-present");
    tdStatus.appendChild(dot);
    tdStatus.appendChild(document.createTextNode(statuses[s.name]==="absent"?"Yok":"Var"));
    tr.appendChild(tdName); tr.appendChild(tdClass); tr.appendChild(tdStatus);
    tbody.appendChild(tr);
  });
}

// --- Öğretmen fonksiyonları (eski kodun buraya gelecek) ---
// renderClassButtons, renderStudentsTable, toggleStatus, addStudent, removeStudent, notifyInstitution, openPanel, closePanel, clearInputs

// --- Giriş Paneli ---
document.addEventListener("DOMContentLoaded",()=>{
  const loginPanel=document.getElementById("loginPanel");
  const passwordPanel=document.getElementById("passwordPanel");
  const teacherBtn=document.getElementById("teacherBtn");
  const parentBtn=document.getElementById("parentBtn");
  const teacherLoginBtn=document.getElementById("teacherLoginBtn");
  const teacherPassword=document.getElementById("teacherPassword");
  const headerEl=document.querySelector("header");
  const mainEl=document.querySelector("main");

  teacherBtn.addEventListener("click",()=>{ passwordPanel.style.display="flex"; });

  teacherLoginBtn.addEventListener("click",()=>{
    if(teacherPassword.value==="elit"){
      isParentMode=false;
      loginPanel.style.display="none";
      headerEl.style.display="block";
      mainEl.style.display="flex";
      loadStudents();
    }else{ alert("Şifre yanlış!"); }
  });

  parentBtn.addEventListener("click",()=>{
    isParentMode=true;
    loginPanel.style.display="none";
    document.getElementById("parentTableWrap").style.display="block";
    loadStudents();
  });

  // Öğretmen modu eventleri
  document.getElementById("btnPanel")?.addEventListener("click",()=>{});
  document.getElementById("overlay")?.addEventListener("click",()=>{});
  document.getElementById("btnClose")?.addEventListener("click",()=>{});
  document.getElementById("btnClear")?.addEventListener("click",()=>{});
  document.getElementById("btnAdd")?.addEventListener("click",()=>{});
  document.getElementById("btnRemove")?.addEventListener("click",()=>{});
  document.getElementById("btnNotify")?.addEventListener("click",()=>{});
});
</script>
</body>
</html>
